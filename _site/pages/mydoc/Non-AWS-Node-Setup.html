<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Setting up Non-AWS Node for MoC/Validator/Bootnode Deployment | POA Network Wiki</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-poa.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="poa-wiki" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> POA Network Wiki</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/poanetwork" target="_blank">GitHub</a></li>
                
                
                
                <li><a href="https://poanet.zendesk.com/hc/en-us" target="_blank">Support Portal</a></li>
                
                
                
                <li><a href="news">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Setting up Non-AWS Node for MoC/Validator/Bootnode Deployment">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="#">Products</a>
      <ul>
          
          
          
          <li><a href="news.html">News</a></li>
          
          
          
          
          
          
          <li><a href="mydoc_introduction.html">Theme instructions</a></li>
          
          
          
          
          
          
          <li><a href="p1_landing_page.html">Product 1</a></li>
          
          
          
          
          
          
          <li><a href="p2_landing_page.html">Product 2</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Setting up Non-AWS Node for MoC/Validator/Bootnode Deployment</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

    <a target="_blank" href="https://github.com//andogro/poa-wiki/blob/gh-pages/pages//pages/mydoc/Non-AWS-Node-Setup.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    


    

  <h2 id="setting-up-non-aws-node-for-mocvalidatorbootnode-deployment">Setting up Non-AWS Node for MoC/Validator/Bootnode Deployment</h2>
<h4 id="minimum-system-requirements">Minimum System Requirements</h4>
<p>Create Ubuntu 16.04 Server Image with minimum of 1 CPU and 1 GB Memory. At the blockchain’s current state, it does not need much HD space. The minimum available should work on any cloud service (4GB or more), but may need to be upgraded in future when more transactions get added to the blockchain.</p>

<p>In order for Ansible Playbook scripts to work, you need to set up your remote machine (validator, bootnode, etc) to have a sudo user that can execute sudo without password. This node also needs to be set up so you can SSH into it using a SSH-Key. Please, follow directions below to set up remote node.</p>

<h2 id="getting-started">Getting Started</h2>
<p>After you obtain your <code class="highlighter-rouge">Public IP</code> from your cloud service, we can now start. Replace <code class="highlighter-rouge">192.0.2.1</code> used in this guide, with your <code class="highlighter-rouge">Public IP</code> throughout the guide. We will use the username <code class="highlighter-rouge">ubuntu</code> in this guide, but if you have a different sudo username, edit <code class="highlighter-rouge">site.yml</code> and change <code class="highlighter-rouge">user: ubuntu</code> to your sudo w/o password user.</p>

<h3 id="root-or-not-to-root">root or not to root</h3>
<p>This guide will assume the cloud service allows you to log in with <code class="highlighter-rouge">root</code>. If you already have a <code class="highlighter-rouge">sudo</code> user, skip to <a href="#execute-sudo-without-password">Execute sudo without password</a> and replace the username <code class="highlighter-rouge">ubuntu</code> &amp; <code class="highlighter-rouge">root</code> used in this guide with your <code class="highlighter-rouge">sudo</code> username and append <code class="highlighter-rouge">sudo</code> in front of the commands below. <strong>Azure</strong> cloud service’s root account is disabled by default so use the user you created during deployment and skip to second section.</p>

<h4 id="connect-and-add-user-with-sudo-privileges">Connect and Add User with Sudo Privileges</h4>
<ol>
  <li>SSH into Remote Node using the root password provided by cloud service (either by web portal or email). If you already have <code class="highlighter-rouge">sudo</code> user, replace <code class="highlighter-rouge">root</code> with your user and skip the next two steps.
    <ul>
      <li>
        <p>Azure users will not have access to their root account by default. Use your sudo user and skip to next section after connecting.</p>

        <p>ssh root@192.0.2.1</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Logged in as <code class="highlighter-rouge">root</code> add user and grant sudo privileges. It is recommended to use default user <code class="highlighter-rouge">ubuntu</code>.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> adduser ubuntu
</code></pre></div>    </div>

    <ul>
      <li>Enter a password to protect the user and you can leave the next 5 fields blank. Confirm the information is correct.</li>
    </ul>
  </li>
  <li>
    <p>Grant user <code class="highlighter-rouge">ubuntu</code> sudo privileges</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> usermod -aG sudo ubuntu
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="execute-sudo-without-password">Execute sudo without password</h4>
<p>One of the requirements for the Ansible script to run properly is root/sudo privileges without password. Since using <code class="highlighter-rouge">root</code> account is not recommended, we add a line of code to allow our <code class="highlighter-rouge">ubuntu</code> user to do just this. <strong>If you are logged into sudo user instead of root, append <code class="highlighter-rouge">sudo</code> to the beginning of each cli command.</strong></p>

<ol>
  <li>
    <p>Create a new file in <code class="highlighter-rouge">sudoers.d</code> directory, this new file can be named anything</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> nano /etc/sudoers.d/user
</code></pre></div>    </div>
  </li>
  <li>
    <p>Enter the line below in the new file and then hit <code class="highlighter-rouge">Ctrl + x</code> to exit <code class="highlighter-rouge">y + Enter</code> to save</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ubuntu ALL=(ALL) NOPASSWD:ALL
</code></pre></div>    </div>

    <ul>
      <li>Replace <code class="highlighter-rouge">ubuntu</code> with your sudo username, if different.</li>
    </ul>
  </li>
  <li>
    <p>Exit current SSH Session to generate/install SSH keys</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> exit
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="generating-ssh-key-and-copying-to-node">Generating SSH Key and Copying to Node</h4>
<ol>
  <li>On your local control machine, let’s generate our SSH keys. It is recommended to use a different SSH Key for each bootnode/validator node deployed. There are two easy ways to do this since SSH by default uses <code class="highlighter-rouge">id_rsa</code> to connect via SSH.
    <ol>
      <li>
        <p>Create new user on local machine for each node to deploy. If done this way, use the default <code class="highlighter-rouge">id_rsa</code> SSH key name while generating SSH key, to be automatically configured.</p>
      </li>
      <li>
        <p>Create a ssh <code class="highlighter-rouge">config</code> file and specify <code class="highlighter-rouge">hostname</code> &amp; <code class="highlighter-rouge">IndentityFile</code> for each node and label keys accordingly. If done this way, please follow the <a href="Multiple-SSH-Keys">Multiple SSH Keys</a> wiki guide.</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     ssh-keygen -t rsa -b 4096 -C "node-label"
</code></pre></div>        </div>
      </li>
    </ol>

    <ul>
      <li>
        <p>If deploying using different local user for each node (multiple deployments only) please leave SSH key name as default <code class="highlighter-rouge">id_rsa</code> by just pressing <code class="highlighter-rouge">enter</code>.</p>
      </li>
      <li>
        <p>Enter a <strong>strong</strong> password (write it down) and save the key as something memorable, enter complete path to key to save as custom name. e.g. below</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ~/.ssh/sokol-bootnode1
</code></pre></div>        </div>

        <ul>
          <li>This will save 2 files, .pub will be your public key and the other is your private key. Private SSH key stays on your local machine and Public key gets copied to remote machines you want access to.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Copy your newly generated SSH key to your remote node</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ssh-copy-id -i ~/.ssh/sokol-bootnode1 ubuntu@192.0.2.1
</code></pre></div>    </div>

    <ul>
      <li>It will ask if you would like to accept the new public key, type <code class="highlighter-rouge">yes + enter</code> and it will automatically add SSH Key to remote machine.</li>
    </ul>
  </li>
</ol>

<p>Your Non-AWS node is now ready for configuration using ansible-playbook provided by POA. Please follow the corresponding section in the wiki to finish deploying your node.</p>

<ul>
  <li><a href="Validator-Node-Non-AWS">Non-AWS Validator Setup</a></li>
  <li><a href="Bootnode-Setup-Non-AWS">Non-AWS Bootnode Setup</a></li>
</ul>


    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2018 POA Network. All rights reserved. <br />
 Site last generated: Sep 10, 2018 <br />
<p><img src="images/POA.png" alt="POA Network" width="144" /></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
